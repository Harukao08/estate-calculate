<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì£¼íƒë‹´ë³´ëŒ€ì¶œ í•œë„ (LTV) ê³„ì‚°ê¸° - ë¶€ë™ì‚°ê³„ì‚°í•˜ê¸°</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700;900&family=Archivo:wght@600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/css/main.css">
    <link rel="stylesheet" href="/css/calculator.css">
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="logo">
            <div class="logo-icon">ë¶€</div>
            <a href="/" style="text-decoration: none; color: inherit;">ë¶€ë™ì‚°ê³„ì‚°í•˜ê¸°</a>
        </div>
    </header>

    <!-- Main Content -->
    <main class="container" style="padding-top: 32px; padding-bottom: 80px;">
        <a href="/buy" class="back-button">
            â† ì§‘ì„ ì‚¬ë ¤ê³  í•´ìš”
        </a>

        <div class="calculator-header">
            <div class="calculator-icon-large">ğŸ¦</div>
            <h1 class="calculator-title">ì£¼íƒë‹´ë³´ëŒ€ì¶œ í•œë„ (LTV)</h1>
            <p class="calculator-subtitle">ì£¼íƒ ê°€ê²© ëŒ€ë¹„ ëŒ€ì¶œ ê°€ëŠ¥í•œ ê¸ˆì•¡ì„ ê³„ì‚°í•©ë‹ˆë‹¤</p>
        </div>

        <!-- LTV ì•ˆë‚´ -->
        <div class="info-box">
            <div class="info-title">
                ğŸ’¡ LTV(ì£¼íƒë‹´ë³´ì¸ì •ë¹„ìœ¨)ë€?
            </div>
            <div class="info-content">
                LTVëŠ” ì£¼íƒ ê°€ê²© ëŒ€ë¹„ ëŒ€ì¶œ ê°€ëŠ¥í•œ ë¹„ìœ¨ì…ë‹ˆë‹¤. 
                ì£¼íƒ ê°€ê²©, ì§€ì—­, ë³´ìœ  ì£¼íƒ ìˆ˜ì— ë”°ë¼ 30%~80%ê¹Œì§€ ë‹¤ì–‘í•˜ê²Œ ì ìš©ë©ë‹ˆë‹¤.
            </div>
        </div>

        <!-- ê³„ì‚° ì…ë ¥ í¼ -->
        <div class="calc-section">
            <h2 class="calc-section-title">ì£¼íƒ ì •ë³´</h2>
            
            <div class="input-group">
                <label class="input-label">ì£¼íƒ ê°€ê²© (KBì‹œì„¸ ë˜ëŠ” ë§¤ë§¤ê°€)</label>
                <div class="input-wrapper">
                    <input type="text" id="housePrice" class="input-field" placeholder="ì˜ˆ: 500000000" inputmode="numeric">
                    <span class="input-suffix">ì›</span>
                </div>
                <div class="input-helper">KBì‹œì„¸, ì‹¤ê±°ë˜ê°€, ê°ì •ê°€ ì¤‘ ë‚®ì€ ê¸ˆì•¡</div>
            </div>

            <div class="input-group">
                <label class="input-label">ì£¼íƒ ìœ í˜•</label>
                <div class="radio-group">
                    <label class="radio-item">
                        <input type="radio" name="houseType" value="apartment" checked>
                        <span class="radio-label">ì•„íŒŒíŠ¸</span>
                    </label>
                    <label class="radio-item">
                        <input type="radio" name="houseType" value="house">
                        <span class="radio-label">ì¼ë°˜ì£¼íƒ (ë‹¨ë…/ì—°ë¦½/ë¹Œë¼)</span>
                    </label>
                </div>
            </div>

            <div class="input-group">
                <label class="input-label">ì£¼íƒ ê°€ê²©ëŒ€</label>
                <div class="radio-group">
                    <label class="radio-item">
                        <input type="radio" name="priceRange" value="under6" checked>
                        <span class="radio-label">6ì–µ ì´í•˜</span>
                    </label>
                    <label class="radio-item">
                        <input type="radio" name="priceRange" value="6to9">
                        <span class="radio-label">6ì–µ ì´ˆê³¼ ~ 9ì–µ ì´í•˜</span>
                    </label>
                    <label class="radio-item">
                        <input type="radio" name="priceRange" value="over9">
                        <span class="radio-label">9ì–µ ì´ˆê³¼</span>
                    </label>
                </div>
            </div>
        </div>

        <div class="calc-section">
            <h2 class="calc-section-title">ë³´ìœ  ì£¼íƒ í˜„í™©</h2>
            
            <div class="input-group">
                <label class="input-label">ë³´ìœ  ì£¼íƒ ìˆ˜ (êµ¬ë§¤ í›„ ê¸°ì¤€)</label>
                <div class="radio-group">
                    <label class="radio-item">
                        <input type="radio" name="housingCount" value="1" checked>
                        <span class="radio-label">1ì£¼íƒ (ìƒì• ìµœì´ˆ í¬í•¨)</span>
                    </label>
                    <label class="radio-item">
                        <input type="radio" name="housingCount" value="2">
                        <span class="radio-label">2ì£¼íƒ</span>
                    </label>
                    <label class="radio-item">
                        <input type="radio" name="housingCount" value="3">
                        <span class="radio-label">3ì£¼íƒ ì´ìƒ</span>
                    </label>
                </div>
            </div>

            <div class="input-group">
                <label class="input-label">ì£¼íƒ ì†Œì¬ì§€</label>
                <div class="radio-group">
                    <label class="radio-item">
                        <input type="radio" name="location" value="regulated" checked>
                        <span class="radio-label">ì¡°ì •ëŒ€ìƒì§€ì—­</span>
                    </label>
                    <label class="radio-item">
                        <input type="radio" name="location" value="normal">
                        <span class="radio-label">ì¼ë°˜ì§€ì—­ (ë¹„ê·œì œ)</span>
                    </label>
                </div>
                <div class="input-helper">ì„œìš¸ ëŒ€ë¶€ë¶„ ì§€ì—­, ìˆ˜ë„ê¶Œ ì¼ë¶€ê°€ ì¡°ì •ëŒ€ìƒì§€ì—­ì…ë‹ˆë‹¤</div>
            </div>

            <div class="input-group">
                <label class="input-label">ëŒ€ì¶œ ìš©ë„</label>
                <div class="radio-group">
                    <label class="radio-item">
                        <input type="radio" name="loanPurpose" value="purchase" checked>
                        <span class="radio-label">ì£¼íƒ êµ¬ë§¤</span>
                    </label>
                    <label class="radio-item">
                        <input type="radio" name="loanPurpose" value="jeonse">
                        <span class="radio-label">ì „ì„¸ìê¸ˆ</span>
                    </label>
                </div>
            </div>

            <button class="calc-button" id="calculateButton">
                LTV í•œë„ ê³„ì‚°í•˜ê¸°
            </button>
        </div>

        <!-- ê²°ê³¼ ì˜ì—­ -->
        <div id="resultSection" class="result-section" style="display: none;">
            <h2 class="result-title">ğŸ’° ê³„ì‚° ê²°ê³¼</h2>
            
            <div class="result-card total">
                <div class="result-label">ìµœëŒ€ ëŒ€ì¶œ ê°€ëŠ¥ ê¸ˆì•¡</div>
                <div class="result-value" id="maxLoanAmount">0ì›</div>
            </div>

            <div class="result-breakdown">
                <h3 class="breakdown-title">LTV ìƒì„¸ ì •ë³´</h3>
                <div class="breakdown-item">
                    <span class="breakdown-label">ì£¼íƒ ê°€ê²©</span>
                    <span class="breakdown-value" id="displayHousePrice">0ì›</span>
                </div>
                <div class="breakdown-item">
                    <span class="breakdown-label">ì ìš© LTV ë¹„ìœ¨</span>
                    <span class="breakdown-value" id="ltvRate">0%</span>
                </div>
                <div class="breakdown-item">
                    <span class="breakdown-label">ëŒ€ì¶œ í•œë„</span>
                    <span class="breakdown-value" id="ltvLimit">0ì›</span>
                </div>
                <div class="breakdown-item">
                    <span class="breakdown-label">í•„ìš” ìê¸°ìë³¸</span>
                    <span class="breakdown-value" id="ownCapital">0ì›</span>
                </div>
            </div>

            <div class="result-info">
                <div class="info-icon">â„¹ï¸</div>
                <div class="info-text" id="ltvInfo"></div>
            </div>

            <div class="result-info" style="background: rgba(255, 87, 51, 0.05); border-color: rgba(255, 87, 51, 0.2);">
                <div class="info-icon">âš ï¸</div>
                <div class="info-text">
                    <strong>ì£¼ì˜:</strong> ì‹¤ì œ ëŒ€ì¶œ ê°€ëŠ¥ ê¸ˆì•¡ì€ LTVì™€ DSR ì¤‘ ë‚®ì€ ê¸ˆì•¡ì´ ì ìš©ë©ë‹ˆë‹¤. 
                    ì†Œë“ì´ ë¶€ì¡±í•˜ë©´ LTV í•œë„ë³´ë‹¤ ì ê²Œ ëŒ€ì¶œë°›ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
                </div>
            </div>

            <div class="result-actions">
                <button class="action-button secondary" id="resetButton">
                    ë‹¤ì‹œ ê³„ì‚°í•˜ê¸°
                </button>
                <button class="action-button primary" id="dsrButton">
                    DSR ê³„ì‚°í•˜ëŸ¬ ê°€ê¸°
                </button>
            </div>
        </div>
    </main>

    <script>
        // DOM ë¡œë“œ ì™„ë£Œ í›„ ì‹¤í–‰
        document.addEventListener('DOMContentLoaded', function() {
            // ê³„ì‚° ë²„íŠ¼ ì´ë²¤íŠ¸
            const calculateButton = document.getElementById('calculateButton');
            if (calculateButton) {
                calculateButton.addEventListener('click', calculateLTV);
            }

            // ë¦¬ì…‹ ë²„íŠ¼ ì´ë²¤íŠ¸
            const resetButton = document.getElementById('resetButton');
            if (resetButton) {
                resetButton.addEventListener('click', resetCalculator);
            }

            // DSR ì´ë™ ë²„íŠ¼
            const dsrButton = document.getElementById('dsrButton');
            if (dsrButton) {
                dsrButton.addEventListener('click', function() {
                    window.location.href = '/calculator/dsr';
                });
            }

            // ìˆ«ì ì…ë ¥ í•„ë“œ í¬ë§·íŒ…
            const housePriceInput = document.getElementById('housePrice');
            if (housePriceInput) {
                housePriceInput.addEventListener('input', function(e) {
                    let value = e.target.value.replace(/[^0-9]/g, '');
                    e.target.value = value;
                });

                // ì—”í„° í‚¤ë¡œ ê³„ì‚°
                housePriceInput.addEventListener('keypress', function(e) {
                    if (e.key === 'Enter') {
                        calculateLTV();
                    }
                });
            }

            // ê°€ê²©ëŒ€ ìë™ ì„ íƒ
            if (housePriceInput) {
                housePriceInput.addEventListener('blur', function() {
                    const price = parseInt(this.value) || 0;
                    if (price > 0) {
                        if (price <= 600000000) {
                            document.querySelector('input[name="priceRange"][value="under6"]').checked = true;
                        } else if (price <= 900000000) {
                            document.querySelector('input[name="priceRange"][value="6to9"]').checked = true;
                        } else {
                            document.querySelector('input[name="priceRange"][value="over9"]').checked = true;
                        }
                    }
                });
            }
        });

        // ìˆ«ì í¬ë§·íŒ…
        function formatNumber(num) {
            return new Intl.NumberFormat('ko-KR').format(Math.floor(num));
        }

        // ì› ë‹¨ìœ„ í‘œì‹œ
        function formatCurrency(num) {
            return formatNumber(num) + 'ì›';
        }

        // ì–µ/ë§Œ ë‹¨ìœ„ í‘œì‹œ
        function formatKoreanCurrency(num) {
            const billion = Math.floor(num / 100000000);
            const tenThousand = Math.floor((num % 100000000) / 10000);
            const remainder = num % 10000;
            
            let result = '';
            if (billion > 0) result += billion + 'ì–µ ';
            if (tenThousand > 0) result += formatNumber(tenThousand) + 'ë§Œ ';
            if (remainder > 0 && billion === 0) result += formatNumber(remainder);
            
            return result.trim() + 'ì›';
        }

        // LTV ê³„ì‚° í•¨ìˆ˜
        function calculateLTV() {
            const housePrice = parseInt(document.getElementById('housePrice').value) || 0;
            
            if (housePrice === 0) {
                alert('ì£¼íƒ ê°€ê²©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }

            const houseType = document.querySelector('input[name="houseType"]:checked').value;
            const priceRange = document.querySelector('input[name="priceRange"]:checked').value;
            const housingCount = parseInt(document.querySelector('input[name="housingCount"]:checked').value);
            const location = document.querySelector('input[name="location"]:checked').value;
            const loanPurpose = document.querySelector('input[name="loanPurpose"]:checked').value;

            let ltvRate = 0;
            let infoMessage = '';

            // LTV ë¹„ìœ¨ ê²°ì •
            if (loanPurpose === 'jeonse') {
                // ì „ì„¸ìê¸ˆ ëŒ€ì¶œ
                if (priceRange === 'under6') {
                    ltvRate = 0.8; // 80%
                    infoMessage = '6ì–µ ì´í•˜ ì „ì„¸ìê¸ˆ ëŒ€ì¶œë¡œ LTV 80%ê°€ ì ìš©ë©ë‹ˆë‹¤.';
                } else if (priceRange === '6to9') {
                    ltvRate = 0.7; // 70%
                    infoMessage = '6~9ì–µ ì „ì„¸ìê¸ˆ ëŒ€ì¶œë¡œ LTV 70%ê°€ ì ìš©ë©ë‹ˆë‹¤.';
                } else {
                    ltvRate = 0.6; // 60%
                    infoMessage = '9ì–µ ì´ˆê³¼ ì „ì„¸ìê¸ˆ ëŒ€ì¶œë¡œ LTV 60%ê°€ ì ìš©ë©ë‹ˆë‹¤.';
                }
            } else {
                // ì£¼íƒ êµ¬ë§¤ ëŒ€ì¶œ
                if (housingCount === 1) {
                    // 1ì£¼íƒ (ìƒì• ìµœì´ˆ í¬í•¨)
                    if (location === 'regulated') {
                        // ì¡°ì •ëŒ€ìƒì§€ì—­
                        if (priceRange === 'under6') {
                            ltvRate = 0.5; // 50%
                            infoMessage = 'ì¡°ì •ëŒ€ìƒì§€ì—­ 1ì£¼íƒ, 6ì–µ ì´í•˜ë¡œ LTV 50%ê°€ ì ìš©ë©ë‹ˆë‹¤.';
                        } else if (priceRange === '6to9') {
                            ltvRate = 0.3; // 30%
                            infoMessage = 'ì¡°ì •ëŒ€ìƒì§€ì—­ 1ì£¼íƒ, 6~9ì–µìœ¼ë¡œ LTV 30%ê°€ ì ìš©ë©ë‹ˆë‹¤.';
                        } else {
                            ltvRate = 0.3; // 30%
                            infoMessage = 'ì¡°ì •ëŒ€ìƒì§€ì—­ 1ì£¼íƒ, 9ì–µ ì´ˆê³¼ë¡œ LTV 30%ê°€ ì ìš©ë©ë‹ˆë‹¤.';
                        }
                    } else {
                        // ì¼ë°˜ì§€ì—­
                        if (priceRange === 'under6') {
                            ltvRate = 0.7; // 70%
                            infoMessage = 'ì¼ë°˜ì§€ì—­ 1ì£¼íƒ, 6ì–µ ì´í•˜ë¡œ LTV 70%ê°€ ì ìš©ë©ë‹ˆë‹¤.';
                        } else if (priceRange === '6to9') {
                            ltvRate = 0.6; // 60%
                            infoMessage = 'ì¼ë°˜ì§€ì—­ 1ì£¼íƒ, 6~9ì–µìœ¼ë¡œ LTV 60%ê°€ ì ìš©ë©ë‹ˆë‹¤.';
                        } else {
                            ltvRate = 0.5; // 50%
                            infoMessage = 'ì¼ë°˜ì§€ì—­ 1ì£¼íƒ, 9ì–µ ì´ˆê³¼ë¡œ LTV 50%ê°€ ì ìš©ë©ë‹ˆë‹¤.';
                        }
                    }
                } else if (housingCount === 2) {
                    // 2ì£¼íƒ
                    if (location === 'regulated') {
                        // ì¡°ì •ëŒ€ìƒì§€ì—­ 2ì£¼íƒ
                        ltvRate = 0.3; // 30%
                        infoMessage = 'ì¡°ì •ëŒ€ìƒì§€ì—­ 2ì£¼íƒìœ¼ë¡œ LTV 30%ê°€ ì ìš©ë©ë‹ˆë‹¤.';
                    } else {
                        // ì¼ë°˜ì§€ì—­ 2ì£¼íƒ
                        if (priceRange === 'under6') {
                            ltvRate = 0.6; // 60%
                            infoMessage = 'ì¼ë°˜ì§€ì—­ 2ì£¼íƒ, 6ì–µ ì´í•˜ë¡œ LTV 60%ê°€ ì ìš©ë©ë‹ˆë‹¤.';
                        } else {
                            ltvRate = 0.5; // 50%
                            infoMessage = 'ì¼ë°˜ì§€ì—­ 2ì£¼íƒ, 6ì–µ ì´ˆê³¼ë¡œ LTV 50%ê°€ ì ìš©ë©ë‹ˆë‹¤.';
                        }
                    }
                } else {
                    // 3ì£¼íƒ ì´ìƒ
                    if (location === 'regulated') {
                        ltvRate = 0; // 0% (ëŒ€ì¶œ ë¶ˆê°€)
                        infoMessage = 'ì¡°ì •ëŒ€ìƒì§€ì—­ 3ì£¼íƒ ì´ìƒì€ ì£¼íƒë‹´ë³´ëŒ€ì¶œì´ ë¶ˆê°€ëŠ¥í•©ë‹ˆë‹¤.';
                    } else {
                        ltvRate = 0.3; // 30%
                        infoMessage = 'ì¼ë°˜ì§€ì—­ 3ì£¼íƒ ì´ìƒìœ¼ë¡œ LTV 30%ê°€ ì ìš©ë©ë‹ˆë‹¤.';
                    }
                }
            }

            // ëŒ€ì¶œ í•œë„ ê³„ì‚°
            const maxLoan = housePrice * ltvRate;
            const ownCapital = housePrice - maxLoan;

            // ê²°ê³¼ í‘œì‹œ
            document.getElementById('maxLoanAmount').textContent = formatKoreanCurrency(maxLoan);
            document.getElementById('displayHousePrice').textContent = formatCurrency(housePrice);
            document.getElementById('ltvRate').textContent = (ltvRate * 100) + '%';
            document.getElementById('ltvLimit').textContent = formatCurrency(maxLoan);
            document.getElementById('ownCapital').textContent = formatCurrency(ownCapital);
            document.getElementById('ltvInfo').textContent = infoMessage;

            // ê²°ê³¼ ì„¹ì…˜ í‘œì‹œ
            document.getElementById('resultSection').style.display = 'block';
            document.getElementById('resultSection').scrollIntoView({ behavior: 'smooth', block: 'nearest' });
        }

        // ê³„ì‚°ê¸° ë¦¬ì…‹
        function resetCalculator() {
            document.getElementById('housePrice').value = '';
            document.querySelector('input[name="houseType"][value="apartment"]').checked = true;
            document.querySelector('input[name="priceRange"][value="under6"]').checked = true;
            document.querySelector('input[name="housingCount"][value="1"]').checked = true;
            document.querySelector('input[name="location"][value="regulated"]').checked = true;
            document.querySelector('input[name="loanPurpose"][value="purchase"]').checked = true;
            document.getElementById('resultSection').style.display = 'none';
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }
    </script>
</body>
</html>
